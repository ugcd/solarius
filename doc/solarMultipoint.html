<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>solarMultipoint. solarius 0.2.4</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">solarius 0.2.4</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Run multipoint linkage analysis.</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>solarMultipoint(formula, data, dir, kinship, traits, covlist&nbsp;=&nbsp;"1", mibddir, chr, interval, multipoint.options&nbsp;=&nbsp;"", multipoint.settings&nbsp;=&nbsp;"", cores&nbsp;=&nbsp;getOption("cores"), ..., verbose&nbsp;=&nbsp;0)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>formula</dt>
      <dd>an object of class <code>formula</code> or one that can be coerced to that class.
It is a symbolic description of fixed effects (covariates) to be fitted.</dd>
      <dt>data</dt>
      <dd>A data frame containing the variables in the model, 
including ID fields needed to construct random effects: genetic and house-hold (both optional).
Other classes such as list, environment or object coercible by <code>as.data.frame</code> to a data frame
are not supported.</dd>
      <dt>dir</dt>
      <dd>an optional character string, the name of directory,
where SOLAR performs the analysis.
In this case, the analysis within related input/output files is 
conducted in the given folder instead of a temporary one
(the default work flow).</dd>
      <dt>kinship</dt>
      <dd>A matrix of the kinship coefficients (custom kinship matrix). 
The IDs are required to be in row and column names.</dd>
      <dt>traits</dt>
      <dd>a vector of characters to specify trait(s) in the model. It is alternative to the formula interface.</dd>
      <dt>covlist</dt>
      <dd>a vector of characters to specify fixed effects (covariates) in the model.
It is alternative to the formula interface.
The default value is <code>"1"</code>.</dd>
      <dt>mibddir</dt>
      <dd>A character, the name of directory with files representing the IBD matrices in SOLAR format.
These matrices can be evaluated by SOLAR or by other program.
See SOLAR help for <code>ibd</code> command for more details
(<a href = 'http://solar.txbiomedgenetics.org/doc/91.appendix_1_text.html#ibd'>http://solar.txbiomedgenetics.org/doc/91.appendix_1_text.html#ibd</a>).</dd>
      <dt>chr</dt>
      <dd>A character or one that can be coerced to that class,
the value to be passed to SOLAR command <code>chromosome</code>.
If it is missing, the default value is <code>"all"</code>.
See SOLAR help for <code>chromosome</code> command for more details
(<a href = 'http://solar.txbiomedgenetics.org/doc/91.appendix_1_text.html#chromosome'>http://solar.txbiomedgenetics.org/doc/91.appendix_1_text.html#chromosome</a>).</dd>
      <dt>interval</dt>
      <dd>A character or one that can be coerced to that class,
the value to be passed to SOLAR command <code>interval</code>.
If it is missing, the default value is <code>1</code>.
See SOLAR help for <code>interval</code> command for more details.</dd>
      <dt>multipoint.options</dt>
      <dd>A character of options to be passed to <code>multipoint</code> SOLAR command.
For example, one or more LOD scores may be specified
to run multi-pass linkage analysis.
If the argument is <code>"3"</code>, that means a two-pass linkage scan
with condition of the highest LOD of <code>3</code> to start the second pass.
See SOLAR help page for <code>multipoint</code> command for more details
(<a href = 'http://solar.txbiomedgenetics.org/doc/91.appendix_1_text.html#multipoint'>http://solar.txbiomedgenetics.org/doc/91.appendix_1_text.html#multipoint</a>).
The default value is <code>""</code>.</dd>
      <dt>multipoint.settings</dt>
      <dd>A vector of characters, that contains SOLAR commands to be executed just before calling <code>multipoint</code>.
For example, the fine mapping for the linkage scan can be disabled
by setting the given argument to <code>"finemap off"</code>.
The default value is <code>""</code>.</dd>
      <dt>cores</dt>
      <dd>A positive integer, the number of cores for parallel computing.
The default value is taken from <code>getOption("cores")</code>.
If the default value is <code>NULL</code> then the number of cores is <code>1</code>.</dd>
      <dt>...</dt>
      <dd>Arguments to be passed to  <code><a href='solarPolygenic.html'>solarPolygenic</a></code> function.
For example, one of such arguments may be <code>polygenic.settings = "option EnableDiscrete 0"</code>.
Arguments of <code>solarMultipoint</code>,
which are also passed to <code><a href='solarPolygenic.html'>solarPolygenic</a></code>,
include <code>formula</code>, <code>data</code>, <code>dir</code>, 
<code>kinship</code>, <code>traits</code> and <code>covlist</code>.</dd>
      <dt>verbose</dt>
      <dd>An non-negative integer of the verbose level.
The default value is <code>0</code>.</dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>

      <p>The linkage analysis is conducted in the following sequence:
parse input files of multipoint IBD matrices,
export data to a directory by <code><a href='df2solar.html'>df2solar</a></code> function, 
run the polygenic analysis in a directory,
run the linkage analysis on the top of the polygenic analysis,
parse output files and 
store results in an object of <code>solarMultipoint</code> class (see <code><a href='solarMultipointClass.html'>solarMultipointClass</a></code>).</p>
  
    </div>

    <div class="Note">
      <h2>Note</h2>

      <p>The user is responsible for computation of the MIBD matrices 
 required by <code>solarMultipoint</code> function via <code>mibddir</code> argument.
 Estimation of the IBD matrices is out of the scope of <code>solarius</code> package.
 More information is available in <a href = 'http://helix.nih.gov/Documentation/solar-6.6.2-doc/05.chapter.html'>http://helix.nih.gov/Documentation/solar-6.6.2-doc/05.chapter.html</a>.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>### load phenotype data 
data(dat30)

### load marker data
mibddir &lt;- system.file(&#39;extdata&#39;, &#39;solarOutput&#39;,
  &#39;solarMibdsCsv&#39;, package = &#39;solarius&#39;) 
list.files(mibddir)
</div>
<div class='output'> [1] &quot;mibd.2.0.gz&quot; &quot;mibd.2.1.gz&quot; &quot;mibd.2.2.gz&quot; &quot;mibd.2.3.gz&quot; &quot;mibd.2.4.gz&quot;
 [6] &quot;mibd.2.5.gz&quot; &quot;mibd.5.0.gz&quot; &quot;mibd.5.1.gz&quot; &quot;mibd.5.2.gz&quot; &quot;mibd.5.3.gz&quot;
[11] &quot;mibd.5.4.gz&quot; &quot;mibd.5.5.gz&quot;
</div>
<div class='input'>
## Not run: 
# ### basic (univariate) linkage model
# mod &lt;- solarMultipoint(trait1 ~ 1, dat30,
#   mibddir = mibddir, chr = 5)
# mod$lodf # table of results (LOD scores) (the highest 3.56)
# 
# ### basic (bivariate) linkage model
# mod &lt;- solarMultipoint(trait1 + trait2 ~ 1, dat30,
#   mibddir = mibddir, chr = 5)
# mod$lodf # table of results (LOD scores) (the highest 2.74)
# 
# ### two-pass linkage model
# mod &lt;- solarMultipoint(trait1 ~ 1, dat30,
#   mibddir = mibddir, chr = 5,
#   multipoint.options = &quot;3&quot;)
# mod$lodf # table of results (LOD scores, 1 pass) (the highest 2.74)
# mod$lodf2 # table of results (LOD scores, 2 pass) (all nearly zero LOD scores)
# 
# ## End(Not run)
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>solarMultipoint</li>
    </ul>
    <ul>
      
    </ul> -->
      
        
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>